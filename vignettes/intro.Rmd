---
title: "Introduction to miRHeat: from input files to heatmap"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Introduction to miRHeat}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```
## Introduction

The **miRHeat** package provides a complete pipeline to:

-   Read output files from **IntaRNA** and **RNAHybrid** for exemple
-   Extract and select numeric columns as **Score**
-   Standardize the data structure for visualization purposes
-   Generate a **miRNA × UTR interaction heatmap** with automatic clustering

It was designed to facilitate the visual inspection of predicted interactions between miRNAs and gene 3'UTR regions.

## Installation

``` r
# install.packages("devtools")
devtools::install_github("bianicoletti/miRHeat")
```

Load the package::

``` r
library(miRHeat)
```

## Example file

The package includes an example file that can be used for demonstration purposes:

``` r
file <- system.file("extdata", "example_blocks.txt", package = "miRHeat")
file
```

## 1. Reading and structuring the data

The first step is to use `parse_file()`:

``` r
df <- parse_file(arquivo)
head(df)
```

## 2. Choosing the Score metric

Predictive softwares can produce multiple numeric columns (energy, ΔG, etc.).

The `select_score()` function automatically identifies the only numeric column or allows you to specify which one should be used:

``` r
df <- select_score(df, score_column = "interaction_energy")
head(df$Score)
```

## 3. Preparing the data for the heatmap

The `prepare_for_heatmap()` function ensures that all required columns are present:

-   `miRNA`
-   `target`
-   `gene`
-   `utr`
-   `Score`

``` r
df <- prepare_for_heatmap(df)
head(df)
```

## 4. Optional filtering

Numeric filters can be applied naturally:

``` r
df_filt <- apply_numeric_filters(df, Score < -10)
```
## 5. Generating a standardized interaction table

In many analyses, users may want to export the processed interaction data for downstream analyses, reporting, or manual inspection, without necessarily generating a heatmap.

The function`mirHeat_table`isolates the table-building step of the pipeline and returns a clean, standardized tibble that can be easily saved or reused. This is how you can use it:

```r
table_df <- mirheat_table(
  file = file,
  score_column = "interaction_energy",
  min_value = -10
)

head(table_df)

# Optional: save table
write.csv(table_df, "miRHeat_interactions.csv", row.names = FALSE)

```

## 6. Generating the final heatmap

The main visualization function is:

``` r
plot_mirheat(df)
```

The plot:

-   automatically builds the miRNA × UTR matrix
-   handles missing values
-   computes distances and clusters
-   determines the optimal number of groups
-   uses`ComplexHeatmap` for rendering

## 7. Exporting the heatmap to a file

``` r
plot_mirheat(df, output_file = "heatmap_miRHeat.png")
```

## Complete Pipeline

``` r
file <- system.file("extdata", "example_blocks.txt", package = "miRHeat")

# Generate standardized interaction table
table_df <- mirheat_table(
  file = file,
  score_column = "interaction_energy",
  min_value = -10
)

# Optional: save table
write.csv(table_df, "miRHeat_interactions.csv", row.names = FALSE)

# Generate heatmap
plot_mirheat(table_df)

```

## Conclusions

**miRHeat** provides a simple and automated workflow to analyze miRNA–3'UTR interactions predicted by IntaRNA — from raw block parsing to the final heatmap visualization.

```{r setup}
library(miRHeat)
```
