README
================

# ğŸ“„ **miRHeat â€” miRNAâ€“UTR Interaction Pipeline**

<img src="man/figures/logo_miRHeat.png" align="right" width="120" />

## ğŸ§¬ **Overview**

This repository contains a complete pipeline for analyzing miRNAâ€“UTR
interactions from block-formatted files. The workflow includes file
parsing, data standardization, application of numeric filters,
construction of a miRNA Ã— UTR matrix, and automated heatmap generation
with cluster detection based on dendrograms.

This package was developed to support bioinformatics and/or biomedical
researchers in handling results generated by miRNAâ€“gene interaction
prediction programs. Its goal is to be easy to use, accommodating both
early-career researchers and experienced professionals, while
facilitating the screening of biologically relevant interactions and the
visualization of binding patterns.

The package is open to suggestions for improvement and constructive
feedback.

## ğŸš€ **Main Features**

- **Reading and parsing** interaction files (`parse_file`)
- **Score selection** for downstream analysis (`select_score`)
- **Custom numeric filters** for minimum energy/score thresholds
  (`apply_numeric_filters`)
- **Data preparation** for heatmap generation (`prepare_for_heatmap`)
- **miRNA Ã— UTR matrix generation**
- **Fully automated heatmap**, including:
  - hierarchical clustering
  - automatic detection of the optimal number of clusters via
    dendrograms (`dynamicTreeCut`)
- Informative messages throughout the entire process

## ğŸ“¦ **Dependencies**

Install the following packages before running the pipeline:

``` r
install.packages(c(
  "tidyverse",
  "reshape2",
  "pheatmap",
  "dynamicTreeCut"
))
```

## Installation

# Install Bioconductor (if not already installed)

if (!requireNamespace(â€œBiocManagerâ€, quietly = TRUE))
install.packages(â€œBiocManagerâ€)

# Install ComplexHeatmap

BiocManager::install(â€œComplexHeatmapâ€)

# Install miRHeat from GitHub

install.packages(â€œremotesâ€)
remotes::install_github(â€œbianicoletti/miRHeatâ€)

## ğŸ› ï¸ **How to Use the Pipeline**

### 1. Load the main script

``` r
source("pipeline_mirna_utr.R")
```

### 2. Run the basic workflow

``` r
df <- parse_file("exemplo_blocos.txt")
df <- select_score(df, score_column = "interaction_energy")
df <- apply_numeric_filters(df, min_value = -8)
df <- prepare_for_heatmap(df)

plot_mirheat(df)
```

The heatmap will be displayed automatically, with the number of clusters
dynamically detected.

### Generating the Interaction Table (`mirHeat_table`)

In addition to heatmap visualization, the pipeline provides a dedicated
function to generate a clean, standardized interaction table that can be
easily inspected, filtered, or exported for downstream analyses.

The `mirHeat_table` function modularizes the workflow by isolating the
table-generation step, allowing users to stop the pipeline before
visualization if desired.

**Why use `mirHeat_table`?**

- Produce a reproducible, analysis-ready table
- Inspect interactions before plotting
- Export results to CSV for sharing or further analysis
- Integrate with external statistical or visualization tools

**Typical usage**

``` r
df <- parse_file("exemplo_blocos.txt")
df <- select_score(df, score_column = "interaction_energy")
df <- apply_numeric_filters(df, min_value = -8)

interaction_table <- mirHeat_table(df)
```

**Exporting the table**

``` r
write.csv(interaction_table,
          file = "outputs/mirna_utr_interactions.csv",
          row.names = FALSE)
```

This table can then be used independently or passed directly to the
heatmap function:

``` r
plot_mirheat(interaction_table)
```

## ğŸ“Š **Output Example**

- Normalized miRNA Ã— UTR matrix
- Colored heatmap with dendrograms
- Automatic cluster assignment

## ğŸ” **Complete Modular Workflow**

``` r
df <- parse_file("exemplo_blocos.txt")
df <- select_score(df, "interaction_energy")
df <- apply_numeric_filters(df, min_value = -8)

interaction_table <- mirHeat_table(df)

plot_mirheat(interaction_table)
```

## ğŸ” **Important Notes**

- The pipeline assumes that the `utr` column contains only the UTR
  number.
- The clustering method is fully automatic but can be manually adjusted
  if needed.
- The pipeline performs best with moderate-sized datasets (hundreds to
  thousands of interactions).

## ğŸ“„ **License**

MIT License
